#set($hits = $publishingentityassethits)


#if($hits)
    <div class="emcarousel" >
		<div class="emcarousel-gallery">
			#set($asset = $hits[0])
			$context.putPageValue("hit", $asset)
			$context.putPageValue("assetid", $asset.id)
			$context.putPageValue("sourcepath", $asset.sourcepath)
			$context.putPageValue("thumbsize", "mediumplus")
			##$pages.include("$componenthome/results/thumbnails/image.html",$context)
			
			
			#set($imagesize = "image550x350.jpg")
			#set($imagelink = $mediaarchive.asLinkToPreview($asset, "", $imagesize, true))
			
			<img src="$!{context.getSiteRoot()}$imagelink" id="emcarousel-image" alt="" data-assetid="$asset.id" /> 
			
		</div>	
        <div class="emcarousel-inner">
        #if ($hits)
            ##<div class="carousel-items">
				#set( $selectedindex = 1)
				#foreach($hit in $hits.getPageOfHits())
					#set( $count = $hits.getPage()+-1 )
					#set( $count = $count*$hits.getHitsPerPage() )	
        			#set( $count = ${foreach.count} + $count )
        			$context.putPageValue("hitindex",$count )
        			#if($asset.id == $hit.id )
        				#set($selectedindex = $count)
					#end        			
        			#set ($sourcepath = $hit.sourcepath)    		
        			#set( $type = $mediaarchive.getMediaRenderType($hit.fileformat))
        			$context.putPageValue("type", $type)
        			
        			#if ($type=="audio")
        				#set( $alwaysmime = true)
        				$context.putPageValue("alwaysmime", $alwaysmime)
        			#end
        			
        			#set($imagesize = "image550x350.jpg")
					#set($imagelink = $mediaarchive.asLinkToPreview($hit, "", $imagesize, true))
                    
                    
                    #set($hitcaption = "")
                    #if ($hit.name)
                        #set($hitcaption = $context.getText($hit.name))
                    #elseif($hit.assettitle)
                        #set($hitcaption = $context.getText($hit.assettitle))
                    #end
				   <div class="emcarousel-item" id="emgallery-$!{hit.id}">
        			<a class="emcarousel-link" data-assetid="$!hit.id" title="$!{hitcaption}" href="$!{context.getSiteRoot()}$imagelink" >
          				$context.putPageValue("hit", $hit)
          				$context.putPageValue("assetid", $hit.id)
						$context.putPageValue("count", $count)
						$context.putPageValue("sourcepath", $hit.sourcepath)
						$context.putPageValue("cdnprefix", $context.getSiteRoot())
						##$context.putPageValue("thumbsize", "carousel")
						$pages.include("$componenthome/results/thumbnails/small.html",$context) 
          			</a>
      			</div>
     			#end
          ##</div>
          #end
        </div>
    </div>
    #if($hitsX)
    <ol class="carousel-indicators"
    data-previouspage="$!hits.idOnPreviousPage()" 
	data-nextpage="$!hits.idOnNextPage()"  >
            <li style="padding:4px;" id="leftpage"><i class="fas fa-arrow-left" ></i></li>
            <li style="padding:4px; width:120px;" >$hits.getPage() [[of]] $hits.getTotalPages()</li>
            <li style="padding:4px;" id="rightpage"><i class="fas fa-arrow-right"></i></li>
    </ol>
    #end
    
#end