<link type="text/css" rel="stylesheet" href="$!siteroot$applink/components/splide/splide.min.css">
<style type="text/css">
	:root {
		--bg-color: #if($publishing.publishingfeedlayout=="light") #fff #else #000 #end;
		--text-color: #if($publishing.publishingfeedlayout=="light") #000 #else #fff #end;
	}
	body {
		font-family: Arial, sans-serif;
		margin: 0;
		padding: 0;
		background-color: var(--bg-color);
		height: 100vh;
		width: 100vw;
	}
	.__main-container {
		position: relative;
		display: flex;
		flex-direction: column;
		height: 100%;
	}
	.__title {
		color: var(--text-color);
		text-align: center;
		margin: 16px 0;
	}
	.__caption {
		max-width: 800px;
		font-size: small;
		color: var(--text-color);
		text-align: center;
		padding-bottom: 16px;
		margin: 0 auto;
	}
	.__caption::after {
		content: "";
		display: block;
		position: absolute;
		width: 100vw;
		left: 0;
		height: 1px;
		background-color: rgba(255, 255, 255, 0.1);
		margin-top: 16px;
	}
	.__carousel-container {
		flex: 1;
		overflow: hidden;
	}
	.__footer {
		font-size: small;
		color: var(--text-color);
		text-align: center;
		padding-top: 16px;
		padding-bottom: 8px;
		margin: 16px 0 0;
		border-top: 0.5px solid rgba(255, 255, 255, 0.1);
	}
	#__carousel {
		height: calc(100% - 60px);
	}
	@media screen and (max-width: 600px) {
		#__carousel {
			height: calc(100% - 44px);
		}
	}
	#__carousel .splide__track {
		height: 100%;
	}
	#__carousel .splide__slide {
		display: flex;
		justify-content: center;
		align-items: center;
		padding: 14px 0;
	}
	#__carousel .splide__slide img {
		width: 100%;
		height: 100%;
		object-fit: contain;
	}
	#__carousel-thumbnails .splide__slide img {
		width: 100%; 
		height: 100%;
		object-fit: cover;
	}
	#__carousel-thumbnails .splide__slide {
		opacity: 0.25;
	}
	#__carousel-thumbnails .splide__slide.is-active {
		opacity: 1;
		border: 1px solid lime;
		box-shadow: 0 0 10px 2px rgba(255, 255, 255, 0.5) inset;
	}
	#__carousel .splide__arrow {
		background-color: rgba(255, 255, 255, 0.05);
		width: 3.5em;
		height: 3.5em;
		padding: 0.5em;
	}
	#__carousel .splide__arrow:hover {
		background-color: rgba(255, 255, 255, 0.1);
	}
	#__carousel .splide__arrow--next {
		right: 1rem;
	}
	#__carousel .splide__arrow--prev {
		left: 1rem;
	}
	#__carousel .splide__arrow svg {
		fill: var(--text-color);
		width: 100%;
		height: 100%;
	}
	#__carousel .__download {
		position: absolute;
		top: 16px;
		left: 16px;
		width: 40px;
		height: 40px;
		border-radius: 20px;
		display: flex;
		justify-content: center;
		align-items: center;
		color: #fff;
		text-decoration: none;
		background-color: rgba(255, 255, 255, 0.1);
		opacity: 0;
		transition: opacity 0.5s;
		z-index: 100;
	}
	#__carousel .is-active .__download {
		opacity: 1;
	}
</style>
<div class="__main-container"> 
	#if($publishing.title_enabled == "true" && $publishing.title)
		<h1 class="__title">$publishing.title</h3>
	#end
	#if($publishing.caption_enabled == "true" && $publishing.caption)
		<div class="__caption">$publishing.caption</div>
	#end
	
	#ifnull($defaultfolder)
		#ifnull($entity)
			#set($defaultfolder =  $mediaarchive.getBean("entityManager").loadDefaultFolderForModule($topmodule, $context.getUser()))
		#end
		#ifnotnull($entity)
			#if($topmodule.getId()=="faceprofilegroup")
				#set($defaultfolder =  $mediaarchive.getBean("entityManager").loadDefaultFolderForModule($topmodule, $context.getUser()))		
			#else
				#set($defaultfolder =  $mediaarchive.getBean("entityManager").createDefaultFolder($entity, $context.getUser()))
			#end
		#end
	#end

	$context.putPageValue("defaultfolder", $defaultfolder)

	#if(!$currentcategoryid && $defaultfolder)
		#set( $currentcategoryid = $defaultfolder.getId())
		$context.putPageValue("categoryid", $currentcategoryid)
	#end
		
	$context.putPageValue("entitydialogid", "entitypublishing")

	<div class="__carousel-container">
		$pages.include("/$mediadbappid/services/publishingdestination/template1/results.html", $context)
	</div>
	
	#if($publishing.footer_enabled=="true" && $publishing.footer)
		<div class="__footer">$publishing.footer</div>
	#end
</div>
<script type="text/javascript" src="$!siteroot$applink/components/splide/splide.min.js"></script>
<script type="text/javascript">
	document.addEventListener("DOMContentLoaded", function () {
		var __main = new Splide("#__carousel", {
			rewind: true,
			pagination: false,
			lazyLoad: "nearby",
			keyboard: 'global',
			autoplay: $publishing.autoplay_enabled,
		});
		var __thumbnail = new Splide("#__carousel-thumbnails", {
			fixedWidth: 95,
			fixedHeight: 60,
			gap: 10,
			rewind: true,
			pagination: false,
			focus: "center",
			isNavigation: true,
			arrows: false,
			breakpoints: {
				600: {
					fixedWidth: 60,
					fixedHeight: 44,
				},
			},
		});
		__main.sync(__thumbnail);
		__main.mount();
		__thumbnail.mount();
	});
</script>