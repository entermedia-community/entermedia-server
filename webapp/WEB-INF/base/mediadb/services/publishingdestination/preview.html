<link type="text/css" rel="stylesheet" href="$!siteroot$applink/components/splide/splide.min.css">
#if($publishing.externalcss_enabled == "true" && $publishing.externalcss)
	<link type="text/css" rel="stylesheet" href="$publishing.externalcss">
#end
<style type="text/css">
	:root {
		--bg-color: #if($publishing.publishingfeedlayout=="dark") #000 #else #efefef #end;
		--text-color: #if($publishing.publishingfeedlayout=="dark") #fff #else #000 #end;
		--highlight-color: #if($publishing.publishingfeedlayout=="dark") #666 #else #444 #end;
	}
	body {
		font-family: Arial, sans-serif;
		margin: 0;
		padding: 0;
		background-color: var(--bg-color);
		height: 100vh;
		width: 100vw;
	}
	.__main-container {
		position: relative;
		display: flex;
		flex-direction: column;
		height: 100%;
	}
	.__title {
		color: var(--text-color);
		text-align: center;
		padding: 16px;
		margin: 0;
		background-color: #fff;
	}
	.__caption {
		font-size: small;
		color: var(--text-color);
		text-align: center;
		margin-bottom: 16px;
		margin: 0 auto;
		background-color: #fff;
		padding-bottom: 8px;
		width: 100%;
	}
	.__caption::after {
		content: "";
		display: block;
		position: absolute;
		width: 100vw;
		left: 0;
		height: 1px;
		background-color: rgba(255, 255, 255, 0.1);
		padding-top: 16px;
	}
	.__carousel-container {
		flex: 1;
		overflow: hidden;
	}
	.__footer {
		font-size: small;
		color: var(--text-color);
		text-align: center;
		padding-top: 16px;
		padding-bottom: 8px;
		margin-top: 8px;
		border-top: 0.5px solid rgba(255, 255, 255, 0.1);
		background-color: #fff;
	}
	#__carousel {
		height: calc(100% - 60px);
	}
	@media screen and (max-width: 600px) {
		#__carousel {
			height: calc(100% - 44px);
		}
	}
	#__carousel .splide__track {
		height: 100%;
	}
	#__carousel .splide__slide {
		display: flex;
		justify-content: center;
		align-items: center;
		padding: 8px 0;
		overflow: hidden;
	}
	#__carousel .splide__slide img {
		width: 100%;
		height: 100%;
		object-fit: contain;
		filter: drop-shadow(4px 0 10px rgba(0, 0, 0, 0.5));
	}
	#__carousel-thumbnails .splide__slide img {
		width: 100%; 
		height: 100%;
		object-fit: cover;
	}
	#__carousel-thumbnails .splide__slide {
		opacity: 0.95;
	}
	#__carousel-thumbnails .splide__slide.is-active {
		opacity: 1;
		border: 2px solid lime;
		box-shadow: 0 0 10px 2px rgba(255, 255, 255, 0.5) inset;
	}
	#__carousel-thumbnails.splide:not(.is-overflow) .splide__list {
		justify-content: center;
}
	#__carousel .splide__arrow {
		color: #fff; 
		width: 7em;
		height: 3.5em;
		padding: 0.5em;
		height: 100%;
		border-radius: 0;
		background-color: transparent;
	} 
	#__carousel .splide__arrow--next {
		padding-left: 0;
		right: 0;
		cursor: e-resize;
	}
	#__carousel .splide__arrow--prev {
		left: 0;
		bottom: 0;
		margin-top: 30px;
		height: calc(100% - 60px);
		cursor: w-resize;
	}
	#__carousel .splide__arrow svg {
		fill: var(--text-color);
		stroke: var(--text-color);
		stroke-width: 1;
		width: 40px;
		height: 40px;
	}
	.__arrow-btn {
		width: 50px;
		height: 50px;
		border-radius: 25px;
		display: flex;
		justify-content: center;
		align-items: center;
		background-color: rgba(255, 255, 255, 0.35);
	}
	.__img_caption {
		position: absolute;
		bottom: 8px;
		left: 50%;
		transform: translateX(-50%);
		display: inline-block;
		color: #fff;
		background: rgba(0, 0, 0, 0.35);
		text-align: center;
		font-style: italic;
		font-size: 1.2rem;
		padding: 12px 16px;
		border-radius: 8px;
		z-index: 10;
		transition: opacity 0.3s ease, transform 0.3s ease;
	}
  .__image:hover .__img_caption {
		opacity: 0;
		transform: translateX(-50%) translateY(100%);
	}
	#__carousel .splide__arrow--prev .__arrow-btn {
		transform: translateY(-30px);
	}
	#__carousel .__download {
		position: absolute;
		top: 16px;
		left: 16px;
		width: 40px;
		height: 40px;
		border-radius: 20px;
		display: flex;
		justify-content: center;
		align-items: center;
		color: #fff;
		background-color: var(--highlight-color);
		text-decoration: none;
		opacity: 0;
		transition: opacity 0.5s;
		z-index: 100;
	}
	#__carousel .splide__slide:hover .__download {
		opacity: 1;
	}
</style>
<div class="__main-container"> 
	#if($publishing.title_enabled == "true" && $publishing.title)
		<h1 class="__title">$publishing.title</h3>
	#end
	#if($publishing.caption_enabled == "true" && $publishing.caption)
		<div class="__caption">$publishing.caption</div>
	#end
	
	#ifnull($defaultfolder)
		#ifnull($entity)
			#set($defaultfolder =  $mediaarchive.getBean("entityManager").loadDefaultFolderForModule($topmodule, $context.getUser()))
		#end
		#ifnotnull($entity)
			#if($topmodule.getId()=="faceprofilegroup")
				#set($defaultfolder =  $mediaarchive.getBean("entityManager").loadDefaultFolderForModule($topmodule, $context.getUser()))		
			#else
				#set($defaultfolder =  $mediaarchive.getBean("entityManager").createDefaultFolder($entity, $context.getUser()))
			#end
		#end
	#end

	$context.putPageValue("defaultfolder", $defaultfolder)

	#if(!$currentcategoryid && $defaultfolder)
		#set( $currentcategoryid = $defaultfolder.getId())
		$context.putPageValue("categoryid", $currentcategoryid)
	#end
		
	$context.putPageValue("entitydialogid", "entitypublishing")

	<div class="__carousel-container">
		$pages.include("/$mediadbappid/services/publishingdestination/template1/results.html", $context)
	</div>
	
	#if($publishing.footer_enabled=="true" && $publishing.footer)
		<div class="__footer">$publishing.footer</div>
	#end
</div>
<script type="text/javascript" src="$!siteroot$applink/components/splide/splide.min.js"></script>
<script type="text/javascript">
	document.addEventListener("DOMContentLoaded", function () {
		var __main = new Splide("#__carousel", {
			rewind: true,
			pagination: false,
			lazyLoad: "nearby",
			keyboard: 'global',
			autoplay: $publishing.autoplay_enabled,
		});
		var __thumbnail = new Splide("#__carousel-thumbnails", {
			fixedWidth: 95,
			fixedHeight: 60,
			gap: 10,
			rewind: true,
			pagination: false,
			isNavigation: true,
			arrows: false,
			breakpoints: {
				600: {
					fixedWidth: 60,
					fixedHeight: 44,
				},
			},
		});
		__main.sync(__thumbnail);
		__main.mount();
		__thumbnail.mount();
	});
</script>